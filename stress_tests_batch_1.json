[
  {
    "id": "ST-001",
    "category": "Booking",
    "trigger": "Shipper attempts to create a booking without completing KYC.",
    "expected_system_behavior": "Block booking creation; present forced KYC flow and specific error message 'KYC_REQUIRED'.",
    "expected_user_behavior": "Shipper completes KYC then retries booking creation.",
    "admin_or_franchise_action": "No immediate admin action; KYC-admin alerted if repeated attempts flagged as suspicious.",
    "failure_condition": "Booking created despite missing KYC or KYC bypassed via UI loophole.",
    "enforcement_rule": "BR-S01 / BR-1 (KYC mandatory before booking).",
    "test_hint": "Attempt booking API call with missing KYC flag; expect HTTP 403 / error code 'KYC_REQUIRED'."
  },
  {
    "id": "ST-002",
    "category": "Bidding",
    "trigger": "Operator places a second simultaneous active bid on the same booking.",
    "expected_system_behavior": "Reject second bid; return error 'ACTIVE_BID_EXISTS'; ensure ledger not charged for rejected attempt.",
    "expected_user_behavior": "Operator receives UI notice and must modify existing active bid instead.",
    "admin_or_franchise_action": "Admin dashboard logs the duplicate attempt; ops lead reviews repeated offenders.",
    "failure_condition": "System accepts multiple active bids for same operator and booking.",
    "enforcement_rule": "BR-O07 / BR-3 (One active bid per operator).",
    "test_hint": "Simulate two concurrent bid POSTs from same operator token; expect second to fail and ledger unchanged."
  },
  {
    "id": "ST-003",
    "category": "Shipment",
    "trigger": "Operator assigns a truck with expired documents and attempts to start the shipment.",
    "expected_system_behavior": "Auto-block truck on assignment; block start-trip action; surface 'TRUCK_DOCS_EXPIRED' error to operator.",
    "expected_user_behavior": "Operator must upload renewed documents and wait for re-inspection before assignment.",
    "admin_or_franchise_action": "Unit Franchise receives inspection task upon document upload; admin notified if assignment attempted repeatedly.",
    "failure_condition": "Shipment moves to IN_TRANSIT with a truck whose documents are expired.",
    "enforcement_rule": "BR-O05 / BR-SL01 (Auto-block on expired documents; inspection cycle).",
    "test_hint": "Assign shipment with truck status set to expired; attempt startTrip; validate system blocks transition."
  },
  {
    "id": "ST-004",
    "category": "Tracking",
    "trigger": "Driver GPS pings stop for 35 minutes during an active shipment (network drop or device issue).",
    "expected_system_behavior": "Generate Tracking Alert; change shipment risk status; notify Operator and Admin; continue attempting pings but mark as 'TRACKING_ALERT'.",
    "expected_user_behavior": "Driver retries connection; Operator monitors and provides updates to Admin; if unresolved, implement fallback per incident SOP.",
    "admin_or_franchise_action": "Admin may open escalation ticket; Unit Franchise may be notified for field verification if location is within their district.",
    "failure_condition": "No alert is generated and shipment remains 'healthy' despite missing pings >30min.",
    "enforcement_rule": "BR-D10 / BR-SL08 (60s ping; alert at 30min).",
    "test_hint": "Simulate gap in location pings >35min; verify alert queue entry and notification emails/webhooks."
  },
  {
    "id": "ST-005",
    "category": "Delivery",
    "trigger": "Driver attempts to complete delivery without entering the shipper OTP.",
    "expected_system_behavior": "Block completion; return error 'OTP_REQUIRED'; do not accept POD upload as final closure until OTP validated.",
    "expected_user_behavior": "Driver requests OTP from shipper via in-app flow; shipper provides OTP and driver completes delivery.",
    "admin_or_franchise_action": "Admin alerted after 3 failed OTP attempts for fraud review; District Franchise may be looped in for repeated incidents.",
    "failure_condition": "System marks shipment as COMPLETED without valid OTP.",
    "enforcement_rule": "BR-D07 / Rule D1 (OTP mandatory for completion).",
    "test_hint": "POST completion without OTP; expect rejection; after correct OTP, expect successful completion and POD acceptance."
  },
  {
    "id": "ST-006",
    "category": "Fraud",
    "trigger": "Repeated identical POD image used across multiple shipments by same driver/operator (pattern indicating reuse).",
    "expected_system_behavior": "Flag as 'POD_REUSE_SUSPECT'; freeze affected shipments; escalate to Admin and KYC-admin for investigation.",
    "expected_user_behavior": "Driver/operator must provide original evidence and undergo POD verification; if unable, shipments remain frozen.",
    "admin_or_franchise_action": "Admin opens fraud ticket; KYC-admin reviews identity and operator history; Unit Franchise may be asked to re-inspect.",
    "failure_condition": "System does not detect reuse pattern and accepts repeated PODs as valid.",
    "enforcement_rule": "BR-FP02 / BR-FP01 (Fake POD triggers audit).",
    "test_hint": "Inject same image hash for POD across 3 shipments; expect automated pattern flag and freeze action."
  },
  {
    "id": "ST-007",
    "category": "Compliance",
    "trigger": "Unit Franchise uploads an inspection report with missing geotag metadata.",
    "expected_system_behavior": "Reject inspection upload; mark inspection 'INVALID_GEO'; require re-upload with geotag; do not change truck status.",
    "expected_user_behavior": "Unit Franchise re-takes photos with geotag enabled and re-submits inspection.",
    "admin_or_franchise_action": "District Franchise notified of repeated invalid geotag submissions for a given unit.",
    "failure_condition": "Inspection accepted without geotag allowing potential fake inspections.",
    "enforcement_rule": "BR-FU02 / BR-7 (Geo-tagging mandatory; inspection validation).",
    "test_hint": "Post inspection payload without geolocation fields; expect 400 rejection with 'INVALID_GEO' error."
  },
  {
    "id": "ST-008",
    "category": "Operator Behavior",
    "trigger": "Operator attempts to add an 11th truck to their fleet via API/portal.",
    "expected_system_behavior": "Reject truck creation with 'MAX_TRUCKS_EXCEEDED'; do not alter operator state or ledger.",
    "expected_user_behavior": "Operator must retire or remove an existing truck before adding new one, or request franchise assistance.",
    "admin_or_franchise_action": "Admin receives infraction log if operator repeatedly attempts to exceed limit.",
    "failure_condition": "System allows >10 trucks for operator, violating onboarding rules.",
    "enforcement_rule": "BR-O03 / BR-31 (Operator max 10 trucks).",
    "test_hint": "POST truck creation when operator already has 10 trucks; expect rejection code and no DB insert."
  },
  {
    "id": "ST-009",
    "category": "Auto-finalization",
    "trigger": "Auto-finalization process selects a bid, but the winning operator's ledger has insufficient balance at finalize time (race condition).",
    "expected_system_behavior": "Re-validate ledger at finalize moment; if insufficient, skip to next-lowest valid bid; notify Admin with race-condition log.",
    "expected_user_behavior": "Winning operator adds funds or loses the shipment; shipper is notified of final winner.",
    "admin_or_franchise_action": "Admin monitors repeated race-condition occurrences; ops lead may tune finalization timing or locking.",
    "failure_condition": "Auto-finalization finalizes a bid and creates shipment despite insufficient ledger leading to inconsistent state.",
    "enforcement_rule": "BR-SL07 / BR-3 (Ledger enforcement & auto-finalization validity).",
    "test_hint": "Simulate concurrent ledger deduction and auto-finalize; expect atomic check-and-lock; skip invalid winner."
  },
  {
    "id": "ST-010",
    "category": "Accident / Alternate Truck",
    "trigger": "Driver reports an accident; Operator assigns an alternate truck that is ineligible (non-HGV or expired docs).",
    "expected_system_behavior": "Reject alternate truck assignment; surface specific error 'ALTERNATE_TRUCK_INELIGIBLE'; require operator to choose compliant truck; keep original shipment in 'FROZEN' until compliant assignment and shipper re-approval.",
    "expected_user_behavior": "Operator selects a compliant truck or requests Admin assistance; Shipper re-approves new driver/truck.",
    "admin_or_franchise_action": "Admin may intervene if operator cannot provide compliant truck within SLA; Unit Franchise to inspect damaged truck.",
    "failure_condition": "System accepts ineligible alternate truck and allows shipment to continue, violating compliance rules.",
    "enforcement_rule": "BR-SL06 / Rule TC1 (Alternate truck must meet eligibility and inspection rules).",
    "test_hint": "Trigger accident flow and attempt to assign a truck with 'eligible': false; expect rejection and shipment freeze."
  },
  {
    "id": "ST-011",
    "category": "Bidding",
    "trigger": "Two operators submit identical lowest bids at near-simultaneous timestamps for the same booking.",
    "expected_system_behavior": "Determine winner by earliest timestamp; if timestamps identical within precision, use deterministic tie-breaker (operator ID lexical order). Log 'TIE_BREAKER_USED'.",
    "expected_user_behavior": "Losing operator notified; winning operator proceeds with assignment.",
    "admin_or_franchise_action": "Admin reviews tie-break audit entry; ops lead handles disputes within SLA.",
    "failure_condition": "System leaves booking unresolved or selects winner nondeterministically.",
    "enforcement_rule": "BR-SL07 / BR-3 (Auto-finalization; earliest timestamp wins).",
    "test_hint": "Simulate two bid POSTs with identical amounts and near-identical timestamps; verify tie-breaker and audit log."
  },
  {
    "id": "ST-012",
    "category": "Shipment",
    "trigger": "Operator assigns a driver but shipper rejects the driver multiple times and operator reassigns the same driver.",
    "expected_system_behavior": "Block re-assignment of the same driver after two consecutive rejections; return 'DRIVER_REASSIGN_BLOCKED'.",
    "expected_user_behavior": "Operator must select a different driver or escalate to Admin; shipper responds within approval SLA.",
    "admin_or_franchise_action": "Admin intervenes after SLA violations; District Franchise notified if pattern indicates operator malpractice.",
    "failure_condition": "System allows infinite reassignments of same rejected driver causing delays.",
    "enforcement_rule": "BR-S10 / BR-S3 (Shipper approval required).",
    "test_hint": "Assign driver → shipper reject twice → attempt reassign same driver; expect block and error code."
  },
  {
    "id": "ST-013",
    "category": "Documentation",
    "trigger": "Driver uploads corrupted or non-PDF file as POD after OTP completion.",
    "expected_system_behavior": "Validate MIME/type and PDF integrity; reject corrupted upload with 'POD_INVALID_FORMAT'; keep shipment in COMPLETED_PENDING_POD.",
    "expected_user_behavior": "Driver re-uploads valid PDF; operator/shipper alerted of pending POD.",
    "admin_or_franchise_action": "Admin requests re-submission evidence; repeated corrupted uploads trigger fraud review.",
    "failure_condition": "System accepts corrupted file and archives invalid POD.",
    "enforcement_rule": "BR-D11 / BR-SL14 (POD mandatory and valid PDF).",
    "test_hint": "Upload broken PDF bytes disguised as .pdf; expect rejection and error."
  },
  {
    "id": "ST-014",
    "category": "Tracking",
    "trigger": "Driver device reports an improbable location jump (e.g., 300 km in 2 minutes) during active shipment.",
    "expected_system_behavior": "Flag 'GPS_JUMP_ANOMALY'; freeze shipment into monitoring state; require driver/operator confirmation and automated cross-checks.",
    "expected_user_behavior": "Driver provides corroborating photo/geotag; operator responds within SLA.",
    "admin_or_franchise_action": "Admin triggers fraud investigation if anomaly persists; Unit Franchise may verify physically.",
    "failure_condition": "System ignores anomaly and continues shipment normally.",
    "enforcement_rule": "BR-FE GPS anomaly handling / BR-D10 (Tracking anomaly detection).",
    "test_hint": "Inject ping sequence with impossible deltas; confirm anomaly flag and 'MONITORING' state."
  },
  {
    "id": "ST-015",
    "category": "Admin Behavior",
    "trigger": "Admin attempts override of compliance-enforced auto-block without documented justification.",
    "expected_system_behavior": "Reject override; require structured justification; log 'UNAUTHORIZED_OVERRIDE_ATTEMPT'; escalate after repeated attempts.",
    "expected_user_behavior": "Admin supplies justification and evidence before override; HQ Compliance reviews.",
    "admin_or_franchise_action": "HQ Compliance audits attempt; repeated infractions trigger access review.",
    "failure_condition": "System allows override without audit trail or justification.",
    "enforcement_rule": "BOS Immutable Rules / GE override policy (justification mandatory).",
    "test_hint": "Call override API with empty justification; expect rejection and audit log increment."
  },
  {
    "id": "ST-016",
    "category": "Delivery",
    "trigger": "Driver enters incorrect OTP more than configured retry limit (e.g., 5 attempts).",
    "expected_system_behavior": "Lock OTP verification for that shipment; set status 'OTP_LOCKED'; trigger admin review and secure re-issue workflow for shipper.",
    "expected_user_behavior": "Driver stops attempts and contacts operator/admin; shipper re-issues OTP after verification.",
    "admin_or_franchise_action": "Admin investigates repeated failures; District Franchise notified for patterns.",
    "failure_condition": "System allows unlimited OTP retries or auto-completes after repeated incorrect attempts.",
    "enforcement_rule": "Rule D1 / BR-D07 (OTP mandatory; retry limits enforced).",
    "test_hint": "Call OTP endpoint with invalid codes 6 times; expect lock at attempt 5 and 'OTP_LOCKED'."
  },
  {
    "id": "ST-017",
    "category": "Franchise",
    "trigger": "Unit Franchise uploads identical inspection photo hashes across multiple distinct truck inspections.",
    "expected_system_behavior": "Flag 'POTENTIAL_FAKE_INSPECTION'; suspend acceptance of new inspections from that unit; queue for District review.",
    "expected_user_behavior": "Unit provides fresh geotagged photos and video evidence; otherwise audits proceed and strikes applied.",
    "admin_or_franchise_action": "District performs immediate audit; if confirmed, apply strike and escalate to HQ.",
    "failure_condition": "System accepts duplicated inspection photos enabling fake onboarding.",
    "enforcement_rule": "BR-FU02 / BR-FU06 (Geo-tagging and anti-fake inspection).",
    "test_hint": "Submit identical image hashes for different truck IDs; expect automated flagging and unit suspension."
  },
  {
    "id": "ST-018",
    "category": "Operator Behavior",
    "trigger": "Operator attempts to place a bid that would drive ledger negative due to concurrent outgoing fees.",
    "expected_system_behavior": "Reject bid atomically; no partial ledger deduction; return 'LEDGER_INSUFFICIENT'.",
    "expected_user_behavior": "Operator tops-up ledger before retrying; UI shows actionable guidance.",
    "admin_or_franchise_action": "Admin monitors frequent insufficient-ledger patterns; operator training/warning may be issued.",
    "failure_condition": "Race condition causes negative ledger or inconsistent bid acceptance.",
    "enforcement_rule": "BR-SL07 / BR-11 (Ledger non-negative enforcement).",
    "test_hint": "Simulate concurrent fee deductions and bid placement; verify atomic failure and no partial writes."
  },
  {
    "id": "ST-019",
    "category": "Driver Behavior",
    "trigger": "Driver arrives at pickup but cannot upload pickup photo due to persistent camera/API failure.",
    "expected_system_behavior": "Block progression to 'AT_PICKUP'; queue retry mechanism; notify operator/admin; allow manual remote verification workflow if device fails for configured window.",
    "expected_user_behavior": "Driver retries; operator arranges alternative evidence or device replacement.",
    "admin_or_franchise_action": "Admin/Unit Franchise may authorize exception if alternate evidence meets policy.",
    "failure_condition": "System permits shipment start without pickup photo.",
    "enforcement_rule": "BR-D04 / BR-SL14 (Pickup photo mandatory).",
    "test_hint": "Simulate pickup without photo; expect 'PENDING_PICKUP_PHOTO' and retry notifications."
  },
  {
    "id": "ST-020",
    "category": "Compliance",
    "trigger": "Unit Franchise delays required re-inspection beyond 24-hour SLA for urgent flagged trucks.",
    "expected_system_behavior": "Raise 'INSPECTION_SLA_VIOLATION' alert; auto-escalate to District and HQ; mark trucks 'HIGH_RISK' and prevent assignments.",
    "expected_user_behavior": "Unit completes inspection immediately; operators cannot use truck for new bids until cleared.",
    "admin_or_franchise_action": "District intervenes and reassigns inspection resources; HQ may place temporary holds on unit activities.",
    "failure_condition": "No alerts/escalations and high-risk trucks continue to be assigned.",
    "enforcement_rule": "BR-FU01 / BR-C01 (Inspection SLA and auto-block).",
    "test_hint": "Flag urgent re-inspection and simulate >24 hours inactivity; expect escalations and truck flagged high-risk."
  },
  {
    "id": "ST-021",
    "category": "Booking",
    "trigger": "Shipper creates a booking with unrealistic pickup-drop pair (route beyond plausible road network).",
    "expected_system_behavior": "Validate route plausibility (distance/time heuristics); flag 'ROUTE_IMPLAUSIBLE' and require shipper confirmation or correction before publishing.",
    "expected_user_behavior": "Shipper reviews suggested corrected route or confirms with justification; system prevents publishing until validated.",
    "admin_or_franchise_action": "Admin reviews repeated implausible route attempts and may contact shipper for verification.",
    "failure_condition": "Booking published with implausible route, leading to failed assignments or fraud.",
    "enforcement_rule": "BR-S01 / BRMS validation (booking completeness & plausibility).",
    "test_hint": "Submit booking with extreme coordinate pairs; expect 'ROUTE_IMPLAUSIBLE' rejection or confirmation step."
  },
  {
    "id": "ST-022",
    "category": "Bidding",
    "trigger": "Operator places an extremely low bid (well below operational minimum) attempting predatory pricing.",
    "expected_system_behavior": "Detect outlier bid against historical/expected price distribution; flag 'PREDATORY_BID' and either require higher security deposit or hold bid for review before making it eligible for auto-finalization.",
    "expected_user_behavior": "Operator notified of hold and given instructions; may increase bid or post justification.",
    "admin_or_franchise_action": "Admin monitors flagged bids; repeat offenders face penalties.",
    "failure_condition": "System accepts predatory bids into auto-finalization causing unfair marketplace outcomes.",
    "enforcement_rule": "BR-5 / BRMS marketplace fairness (outlier detection).",
    "test_hint": "Post bid at 30% of expected price; expect hold and 'PREDATORY_BID' flag."
  },
  {
    "id": "ST-023",
    "category": "Shipment",
    "trigger": "A shipment's assigned driver is reported by operator as unavailable after assignment but before shipper approval expiry.",
    "expected_system_behavior": "Mark driver as 'UNAVAILABLE'; require operator to assign alternate driver and re-request shipper approval; keep shipment in 'ASSIGNING_DRIVER' state and start SLA timer for reassignment.",
    "expected_user_behavior": "Operator picks alternate driver promptly; shipper re-approves for new driver.",
    "admin_or_franchise_action": "If reassignment exceeds SLA, Admin intervenes to reassign or escalate.",
    "failure_condition": "Shipment proceeds without valid assigned driver or without shipper approval.",
    "enforcement_rule": "BR-O13 / BR-S3 (Driver assignment & shipper approval flow).",
    "test_hint": "Simulate driver unavailable after assignment; ensure shipment stays in assigning state and SLA timers start."
  },
  {
    "id": "ST-024",
    "category": "Tracking",
    "trigger": "Network-heavy region causes intermittent pings; location pings arrive but with high latency and missing sequence numbers.",
    "expected_system_behavior": "Treat as intermittent connectivity; mark shipment 'DEGRADED_TRACKING' while continuing to append pings; notify Operator/Admin; do not immediately freeze unless >30min gap.",
    "expected_user_behavior": "Driver continues work; operator monitors and provides situational updates.",
    "admin_or_franchise_action": "Admin monitors multiple degraded cases; Unit Franchise may assist if local verification needed.",
    "failure_condition": "System treats degraded pings as normal or immediately freezes without tolerance, causing false positives or false negatives.",
    "enforcement_rule": "BR-D10 / BR-SL08 (tracking gap tolerance and alerting).",
    "test_hint": "Simulate intermittent pings with out-of-order timestamps; expect 'DEGRADED_TRACKING' state and notifications."
  },
  {
    "id": "ST-025",
    "category": "Fraud",
    "trigger": "Operator account exhibits sudden bidding pattern change: many very low bids across diverse geographies within short time.",
    "expected_system_behavior": "Flag account for 'SUSPICIOUS_BIDDING_PATTERN'; temporarily restrict bidding privileges pending investigation; log activity for fraud engine correlation.",
    "expected_user_behavior": "Operator receives notification of temporary restriction and instructions to contact support.",
    "admin_or_franchise_action": "Admin reviews pattern and either lifts restriction after verification or escalates for ban.",
    "failure_condition": "System ignores pattern allowing potential collusion or market manipulation.",
    "enforcement_rule": "BR-FP04 / BRMS fraud detection (collusive bidding patterns).",
    "test_hint": "Simulate many low bids from same operator across regions within 1 hour; expect suspension and alert."
  },
  {
    "id": "ST-026",
    "category": "Documentation",
    "trigger": "Operator updates truck ownership (change of owner) without performing full re-inspection.",
    "expected_system_behavior": "Require deactivation of truck under old owner, queue for full re-inspection, mark truck 'PENDING_REINSPECTION' and prevent bidding until re-verified.",
    "expected_user_behavior": "Operator must submit ownership transfer documentation and wait for Unit Franchise re-inspection.",
    "admin_or_franchise_action": "Unit Franchise conducts mandatory re-inspection; District audits if chain-of-custody concerns arise.",
    "failure_condition": "Truck remains active and participates in bids under new owner without re-inspection.",
    "enforcement_rule": "BR-4 / Truck ownership & re-inspection policy (ownership change rules).",
    "test_hint": "Submit ownership change event and attempt to enable truck for bidding; expect block and 'PENDING_REINSPECTION' status."
  },
  {
    "id": "ST-027",
    "category": "Operator Behavior",
    "trigger": "Operator programmatically attempts to mass-edit truck metadata (e.g., change tonnage/permit numbers) to bypass validation.",
    "expected_system_behavior": "Validate all edits against locked fields; reject attempts to modify immutable fields and log 'METADATA_TAMPER_ATTEMPT'; rate-limit edit API and escalate repeated attempts.",
    "expected_user_behavior": "Operator must open support ticket for legitimate metadata corrections with documentary proof.",
    "admin_or_franchise_action": "Admin reviews tamper logs; if malicious, initiate fraud investigation and possible suspension.",
    "failure_condition": "System accepts edits to immutable fields causing compliance breaches.",
    "enforcement_rule": "BR-33 / Data integrity rules (immutable truck fields).",
    "test_hint": "Attempt API PATCH modifying protected truck fields; expect 403 and tamper log entry."
  },
  {
    "id": "ST-028",
    "category": "Delivery",
    "trigger": "Shipper marks delivery dispute claiming damaged goods despite valid POD and GPS showing arrival.",
    "expected_system_behavior": "Open dispute case; freeze settlement actions; collect full audit (POD, photos, GPS timeline) and route to Admin for adjudication; allow driver/operator to submit additional evidence.",
    "expected_user_behavior": "Shipper provides claim details; operator/driver provides counter-evidence; both parties await Admin resolution.",
    "admin_or_franchise_action": "Admin adjudicates with evidence; District Franchise may inspect cargo if feasible; final ruling recorded and enforced.",
    "failure_condition": "System auto-dismisses dispute or auto-favors one party without evidence collection.",
    "enforcement_rule": "BR-FP06 / Dispute & evidence policy (collect POD + GPS before decision).",
    "test_hint": "Trigger dispute flow with POD & GPS present; ensure evidence collection page and Admin queue item."
  },
  {
    "id": "ST-029",
    "category": "Tracking",
    "trigger": "Driver's device reports GPS coordinates that match a known spoofing signature or emulator fingerprint.",
    "expected_system_behavior": "Flag 'GPS_SPOOF_SIGNATURE'; freeze affected shipments in monitoring state; require driver/operator proof (photo with live timestamp) and KYC-admin review if repeated.",
    "expected_user_behavior": "Driver must provide corroborating live evidence; operator coordinates replacement if spoofing cannot be resolved.",
    "admin_or_franchise_action": "Admin triggers fraud investigation and may suspend the device/account; Unit Franchise may do field verification.",
    "failure_condition": "System ignores spoof signatures and accepts spoofed pings as valid.",
    "enforcement_rule": "BR-FE spoof detection rules / FE outputs (freeze & investigate).",
    "test_hint": "Simulate GPS pings with spoofed metadata signatures; expect immediate flag and monitoring state."
  },
  {
    "id": "ST-030",
    "category": "Franchise",
    "trigger": "District Franchise approves a batch of Unit inspections that automated checks flagged as suspicious (high failure rate).",
    "expected_system_behavior": "If District overrides system suspicion, require mandatory justification and attached evidence; log override as 'DISTRICT_OVERRIDE_SUSPICIOUS'; raise HQ alert for review and possible audit of District actions.",
    "expected_user_behavior": "District provides justification and detailed notes; Unit receives instructions for corrective actions if needed.",
    "admin_or_franchise_action": "HQ audits the override; if abuse detected, apply strikes to District and remedial measures.",
    "failure_condition": "District routinely overrides suspicious inspections without accountability, enabling fake trucks to pass.",
    "enforcement_rule": "BR-FD02 / Franchise override governance (justification + HQ alert).",
    "test_hint": "Simulate District approval on flagged inspections; expect forced justification field and HQ alert record."
  },
  {
    "id": "ST-031",
    "category": "Booking",
    "trigger": "Shipper edits a booking after bids have been placed, changing tonnage or route significantly.",
    "expected_system_behavior": "Block edits that materially change bid parameters; convert edit attempt into 'REOPEN_FOR_BIDDING' flow if allowed by policy, otherwise reject and instruct shipper to create a new booking.",
    "expected_user_behavior": "Shipper either creates a new booking or accepts that existing bids are void; notified of implications.",
    "admin_or_franchise_action": "Admin reviews edge cases where immediate edit is necessary (e.g., emergency route change) and may open an exception with justification.",
    "failure_condition": "System permits material edits mid-bid causing operators to be unfairly disadvantaged.",
    "enforcement_rule": "BR-S03 / Booking modification restrictions (no material changes after bids).",
    "test_hint": "Attempt PATCH booking with large tonnage/route change after bids exist; expect rejection or controlled reopen workflow."
  },
  {
    "id": "ST-032",
    "category": "Bidding",
    "trigger": "Operator uses API automation to flood the marketplace with frequent bid updates to gain algorithmic advantage.",
    "expected_system_behavior": "Rate-limit bid modifications per operator (configurable); detect high-frequency patterns and throttle or require captcha/2FA; log 'BID_FLOOD_DETECTED'.",
    "expected_user_behavior": "Operator slows update frequency or requests higher-tier access for allowed higher rates.",
    "admin_or_franchise_action": "Admin reviews throttling logs and may provision exceptions for verified operators under SLA.",
    "failure_condition": "System allows unbounded bid update frequency, enabling algorithmic abuse.",
    "enforcement_rule": "BR-O08 / Marketplace abuse prevention (rate limiting).",
    "test_hint": "Simulate 100 rapid bid modifications; expect rate-limit responses and 'BID_FLOOD_DETECTED' logs."
  },
  {
    "id": "ST-033",
    "category": "Shipment",
    "trigger": "Operator assigns a telematics-enabled truck but the telematics feed shows inconsistent VIN/vehicle ID compared to registered truck.",
    "expected_system_behavior": "Flag 'TELEMATICS_MISMATCH'; pause telematics-driven automation (e.g., auto-tracking) and require manual verification; block auto-accept features dependent on telematics.",
    "expected_user_behavior": "Operator provides telematics vendor proof and reconciles VIN mapping; Unit Franchise may inspect if needed.",
    "admin_or_franchise_action": "Admin audits mismatch; District Franchise may require physical VIN verification.",
    "failure_condition": "System trusts mismatched telematics feed, resulting in incorrect truck tracking and accountability issues.",
    "enforcement_rule": "BR-3 / Telematics data integrity rules (VIN reconciliation).",
    "test_hint": "Inject telematics feed with different VIN; expect 'TELEMATICS_MISMATCH' flag and paused automation."
  },
  {
    "id": "ST-034",
    "category": "Tracking",
    "trigger": "High-frequency location pings cause storage or processing backpressure leading to delayed alerting.",
    "expected_system_behavior": "Apply sampling/backpressure policies (e.g., aggregate high-frequency pings into summaries) while preserving anomaly detection; maintain real-time alerting SLA by computing anomalies on stream without persisting every raw ping.",
    "expected_user_behavior": "Driver continues; Operator sees slightly smoothed track in UI but alerts remain timely.",
    "admin_or_franchise_action": "Ops monitors system load and may tune sampling thresholds for region-specific behavior.",
    "failure_condition": "System backlog delays critical alerts causing missed incidents.",
    "enforcement_rule": "BR-SL08 / Tracking processing resilience (sampling + streaming anomaly detection).",
    "test_hint": "Replay very high-rate ping stream; verify sampling applied and anomaly alerts still fire within SLA."
  },
  {
    "id": "ST-035",
    "category": "Compliance",
    "trigger": "A truck's insurance policy is near expiry and system sends reminders but operator repeatedly ignores notices.",
    "expected_system_behavior": "Escalate to auto-block on expiry date; after repeated ignored reminders before expiry, flag operator for compliance coaching and prevent new bids 7 days prior to expiry if configured.",
    "expected_user_behavior": "Operator renews insurance and uploads documents; truck returns to active after re-inspection if required.",
    "admin_or_franchise_action": "Unit Franchise schedules inspection upon renewal; District notified of repeat offenders.",
    "failure_condition": "Truck continues to bid/use past insurance expiry due to ignored reminders.",
    "enforcement_rule": "BR-SL01 / Document expiry and pre-expiry prevention policies.",
    "test_hint": "Set insurance expiry near and ignore reminders; on expiry attempt to bid and expect auto-block."
  },
  {
    "id": "ST-036",
    "category": "Operator Behavior",
    "trigger": "Operator attempts to bypass phone-number masking by embedding contact details in bid comment fields.",
    "expected_system_behavior": "Detect PII patterns in free-text fields and redact/mask before display; if PII detected, flag the bid and sanitize content; log 'PII_LEAK_ATTEMPT'.",
    "expected_user_behavior": "Operator refrains from embedding contact info; uses platform-approved contact workflows.",
    "admin_or_franchise_action": "Admin reviews PII leaks; repeated violations cause warnings or suspension.",
    "failure_condition": "PII displayed to shipper or other operators, breaking privacy rules.",
    "enforcement_rule": "BR-11 / Masking & PII protection policies.",
    "test_hint": "Submit bid with phone/email in notes; verify masking/redaction and 'PII_LEAK_ATTEMPT' log."
  },
  {
    "id": "ST-037",
    "category": "Documentation",
    "trigger": "Operator uploads a document image where text fields (permit numbers) are intentionally blurred or obfuscated.",
    "expected_system_behavior": "Run OCR quality checks; if critical fields unreadable, reject and request clearer images; escalate repeated low-quality submissions to Unit Franchise for manual review.",
    "expected_user_behavior": "Operator re-submits legible documents or provides certified copies via franchise channel.",
    "admin_or_franchise_action": "Unit Franchise inspects and may accept certified copies in exceptional cases with HQ approval.",
    "failure_condition": "System accepts obfuscated docs enabling illegitimate truck usage.",
    "enforcement_rule": "BR-FU02 / Document clarity & OCR verification policies.",
    "test_hint": "Upload heavily blurred RC image; expect rejection with 'DOC_UNREADABLE'."
  },
  {
    "id": "ST-038",
    "category": "Delivery",
    "trigger": "Driver uploads POD but timestamp metadata is outside expected window (e.g., backdated or future timestamp).",
    "expected_system_behavior": "Validate file timestamp against shipment timeline; if mismatch, flag POD as 'TIMESTAMP_MISMATCH' and require fresh evidence; hold settlement actions until validated.",
    "expected_user_behavior": "Driver re-captures POD with correct live timestamp or provides corroborating evidence.",
    "admin_or_franchise_action": "Admin reviews timestamp anomalies and may require Unit Franchise spot-checks.",
    "failure_condition": "System accepts backdated/future-dated POD leading to fraudulent completions.",
    "enforcement_rule": "BR-D11 / POD timestamp validation rules.",
    "test_hint": "Upload POD PDF with altered metadata timestamp; expect 'TIMESTAMP_MISMATCH' flag and hold."
  },
  {
    "id": "ST-039",
    "category": "Tracking",
    "trigger": "Cross-border-style route where a booking seems to cross state boundaries but truck's permit/National Permit doesn't allow inter-state operation.",
    "expected_system_behavior": "Detect permit restrictions vs route; block assignment for non-compliant permits and inform operator to provide valid National Permit or adjust route; flag 'PERMIT_MISMATCH'.",
    "expected_user_behavior": "Operator provides valid permit or refuses booking; shipper updates route as needed.",
    "admin_or_franchise_action": "Admin reviews exception requests and may coordinate with operator/franchise for legal compliance.",
    "failure_condition": "Shipment allowed despite permit mismatch, exposing legal/regulatory risk.",
    "enforcement_rule": "BR-3 / Permit & National Permit enforcement.",
    "test_hint": "Create booking crossing states; attempt assign truck lacking NP; expect 'PERMIT_MISMATCH' rejection."
  },
  {
    "id": "ST-040",
    "category": "Franchise",
    "trigger": "Unit Franchise account shows access from multiple geographically distant IPs within short timespan indicating credential compromise.",
    "expected_system_behavior": "Trigger 'FRANCHISE_ACCOUNT_COMPROMISE' alert; immediately suspend write access pending SSO/2FA revalidation; require re-authentication and security review.",
    "expected_user_behavior": "Franchise admin performs re-authentication and security remediation; HQ coordinates password/credential reset and audit.",
    "admin_or_franchise_action": "HQ Security team investigates and issues remedial steps; District Franchise notified.",
    "failure_condition": "Compromised franchise credentials remain active enabling fraudulent inspections or approvals.",
    "enforcement_rule": "BR-FU02 / Account security & SSO/2FA policies.",
    "test_hint": "Simulate login events from distant IPs for same franchise user; expect immediate suspend-write and security alert."
  },
  {
    "id": "ST-041",
    "category": "Booking",
    "trigger": "Shipper attempts to post duplicate booking (same pickup, drop, goods, tonnage) within a short window.",
    "expected_system_behavior": "Detect duplicate intent via similarity hash; surface 'DUPLICATE_BOOKING_SUSPECT' and prompt shipper to confirm dedup or cancel; prevent duplicate publication automatically.",
    "expected_user_behavior": "Shipper confirms dedup or cancels redundant posting.",
    "admin_or_franchise_action": "Admin reviews high-frequency duplicate attempts for potential abuse.",
    "failure_condition": "System creates duplicate bookings leading to resource contention and conflicting bids.",
    "enforcement_rule": "BR-S01 / Booking deduplication policy.",
    "test_hint": "Submit identical booking payload twice within short window; expect prompt and second not published until confirmed."
  },
  {
    "id": "ST-042",
    "category": "Bidding",
    "trigger": "Operator's bid update causes the bidding fee calculation to change (e.g., tonnage adjusted) resulting in fee mismatch mid-transaction.",
    "expected_system_behavior": "Recompute fee atomically; if fee increased and ledger insufficient, reject update and return 'BIDDING_FEE_MISMATCH'; do not accept partial state.",
    "expected_user_behavior": "Operator reviews new fee and tops up ledger or cancels bid update.",
    "admin_or_franchise_action": "Admin monitors frequent fee mismatches for UX or calculation defects.",
    "failure_condition": "System accepts bid update without reconciling fee change leading to negative ledger or inconsistent accounting.",
    "enforcement_rule": "BR-SL07 / Bidding fee atomicity policy.",
    "test_hint": "Simulate a bid PATCH that alters tonnage; ensure fee is recomputed and ledger validated atomically."
  },
  {
    "id": "ST-043",
    "category": "Shipment",
    "trigger": "Shipment contains multiple stops; driver attempts to mark intermediate stop as complete without required photo/OTP for that stop.",
    "expected_system_behavior": "Block intermediate stop completion; require stop-specific evidence (photo and stop-OTP if configured) before allowing progress to next stop; set shipment multi-stop sub-state accordingly.",
    "expected_user_behavior": "Driver uploads required evidence for each stop; shipper(s) confirm OTPs if multi-shipper workflow.",
    "admin_or_franchise_action": "Admin reviews repeated missing-stop evidence patterns and may require additional driver controls.",
    "failure_condition": "System allows skip of stop evidence enabling partial non-delivery or disputes.",
    "enforcement_rule": "BR-D04 / Multi-stop delivery evidence policy.",
    "test_hint": "Create multi-stop shipment and attempt to mark stop complete without photo/OTP; expect rejection and 'STOP_EVIDENCE_MISSING'."
  },
  {
    "id": "ST-044",
    "category": "Tracking",
    "trigger": "Driver's location data includes excessive noise (jitter) caused by low-accuracy GPS; route appears zigzagging on map.",
    "expected_system_behavior": "Apply smoothing algorithm server-side (e.g., Kalman filter) for UI display and anomaly detection; preserve raw pings for audit; do not raise false deviation alerts due to jitter.",
    "expected_user_behavior": "Driver continues as normal; operator sees smoothed route in UI.",
    "admin_or_franchise_action": "Ops reviews regions with high jitter and may adjust polling or advise device settings.",
    "failure_condition": "Raw jitter triggers false route deviation alerts and unnecessary escalations.",
    "enforcement_rule": "BR-D10 / Tracking smoothing & preservation policy.",
    "test_hint": "Feed noisy ping stream and validate UI smoothing while raw data stored for audit."
  },
  {
    "id": "ST-045",
    "category": "Compliance",
    "trigger": "A blocked truck gets restored after document upload but photos show obvious tampering (e.g., edited number plate image).",
    "expected_system_behavior": "Run image tamper detection; if tampering suspected, keep truck blocked and escalate to Unit/District for physical verification; log 'PHOTO_TAMPER_SUSPECT'.",
    "expected_user_behavior": "Operator provides original certified documents and schedules physical re-inspection.",
    "admin_or_franchise_action": "Unit Franchise performs on-ground verification; District escalates if tampering confirmed.",
    "failure_condition": "System trusts tampered images and unblocks illegitimate trucks.",
    "enforcement_rule": "BR-FU02 / Photo tamper detection & re-inspection policy.",
    "test_hint": "Upload doctored plate photo with subtle edits; expect tamper flag and blocked state pending manual verification."
  },
  {
    "id": "ST-046",
    "category": "Operator Behavior",
    "trigger": "Operator API client uses outdated SDK causing malformed requests that bypass client-side validation.",
    "expected_system_behavior": "Server-side validation schema rejects malformed payloads with clear error codes; log client version and recommend SDK upgrade; do not accept insecure payloads.",
    "expected_user_behavior": "Operator upgrades SDK or fixes integration per server guidance.",
    "admin_or_franchise_action": "Platform engineering tracks affected operators and offers migration assistance.",
    "failure_condition": "Malformed requests accepted leading to inconsistent state or security holes.",
    "enforcement_rule": "BR-33 / Server-side validation & client compatibility policy.",
    "test_hint": "Send malformed POST/JSON payload; expect 4xx with validation errors and client-version log."
  },
  {
    "id": "ST-047",
    "category": "Delivery",
    "trigger": "Driver attempts to upload POD that exceeds file size limits (e.g., >25MB) or unsupported format.",
    "expected_system_behavior": "Reject upload with 'POD_TOO_LARGE' or 'INVALID_POD_FORMAT' and provide clear instructions for compression or alternative submission via franchise channel.",
    "expected_user_behavior": "Driver compresses file or uses alternate allowed format and re-uploads.",
    "admin_or_franchise_action": "Admin may accept certified POD via franchise channel for exceptional cases.",
    "failure_condition": "System accepts oversized/unsupported POD causing storage and retrieval issues.",
    "enforcement_rule": "BR-FU06 / POD size & format policy (25MB limit).",
    "test_hint": "POST POD file >25MB or .exe disguised as .pdf; expect rejection and instructional error."
  },
  {
    "id": "ST-048",
    "category": "Tracking",
    "trigger": "System time drift between driver device and server causes timestamp mismatches in logs.",
    "expected_system_behavior": "Normalize timestamps using server-side authoritative time; record device-server offset in logs; if offset exceeds threshold, flag device for time-sync and notify operator.",
    "expected_user_behavior": "Driver updates device time settings or reinstalls app per guidance.",
    "admin_or_franchise_action": "Ops may contact driver to assist in correcting device time or mark device non-compliant until fixed.",
    "failure_condition": "Mixing device timestamps causes incorrect sequence and OTP/POD verification windows to fail.",
    "enforcement_rule": "BR-SL08 / Time normalization & device sync policy.",
    "test_hint": "Send pings with device clock 2 hours ahead; verify server normalizes and logs offset, and flags device if threshold exceeded."
  },
  {
    "id": "ST-049",
    "category": "Franchise",
    "trigger": "Unit Franchise attempts bulk export of KYC-adjacent metadata for analytics (risk of sensitive data leak).",
    "expected_system_behavior": "Block export of any PII/KYC-adjacent fields; allow only aggregated non-identifying metrics; require export justification and KYC-admin approval for sensitive exports.",
    "expected_user_behavior": "Franchise requests aggregated report or provides justification for sensitive data export via HQ process.",
    "admin_or_franchise_action": "HQ Compliance reviews export requests and approves or denies.",
    "failure_condition": "Sensitive KYC data exported to franchise systems causing privacy violations.",
    "enforcement_rule": "BR-8 / Data privacy & export control policy.",
    "test_hint": "Attempt export including phone/license fields from franchise account; expect denial and audit entry."
  },
  {
    "id": "ST-050",
    "category": "Fraud",
    "trigger": "Multiple driver accounts tied to same device ID attempt to accept overlapping shipments (device-sharing abuse).",
    "expected_system_behavior": "Detect many-to-one device relationships and flag 'DEVICE_ACCOUNT_COLLISION'; prevent overlapping acceptances from same device and require device binding verification; escalate to Admin for account audit.",
    "expected_user_behavior": "Operators/drivers must disambiguate accounts and bind unique devices per driver; provide evidence if necessary.",
    "admin_or_franchise_action": "Admin audits accounts; suspend suspicious accounts pending verification.",
    "failure_condition": "System allows shared-device overlapping shipments enabling fraud and SLA violations.",
    "enforcement_rule": "BR-FE / Device-account binding & anti-sharing policy.",
    "test_hint": "Simulate multiple driver logins from same device ID accepting different shipments; expect collision flag and blocking of overlapping acceptances."
  },
  {
    "id": "ST-051",
    "category": "Booking",
    "trigger": "Shipper attempts to schedule a booking far in the future beyond configured system horizon (e.g., >365 days).",
    "expected_system_behavior": "Reject or require special approval; return 'BOOKING_DATE_OUT_OF_RANGE' and present option to request long-term scheduling via HQ review.",
    "expected_user_behavior": "Shipper uses approval workflow or selects allowed date range.",
    "admin_or_franchise_action": "Admin reviews long-horizon requests and approves with justification if business-acceptable.",
    "failure_condition": "System accepts extremely long-dated bookings causing scheduling and resource planning issues.",
    "enforcement_rule": "BR-S01 / Booking date horizon policy.",
    "test_hint": "POST booking with pickup date >365 days ahead; expect rejection or 'REQUEST_SCHEDULING_APPROVAL' flow."
  },
  {
    "id": "ST-052",
    "category": "Bidding",
    "trigger": "Operator account is suspended during an active bid window (e.g., due to compliance), while their bid is still live.",
    "expected_system_behavior": "Automatically invalidate any live bids from suspended accounts and mark as 'BID_INVALIDATED_ACCOUNT_SUSPENDED'; notify shipper and recalculate auto-finalization pool.",
    "expected_user_behavior": "Suspended operator cannot win or modify bids; operator addresses suspension via support.",
    "admin_or_franchise_action": "Admin documents suspension cause and ensures accounting corrections if fee was charged incorrectly.",
    "failure_condition": "System leaves suspended operator bid active and potentially finalizes it.",
    "enforcement_rule": "BR-O07 / Suspension handling for active bids.",
    "test_hint": "Suspend operator while bid active; ensure bid invalidation and pool recalculation."
  },
  {
    "id": "ST-053",
    "category": "Shipment",
    "trigger": "Multiple shipments are chained (back-to-back) for same truck without required rest window violating safety rules.",
    "expected_system_behavior": "Enforce mandatory rest windows; prevent assignment that violates driver rest regulations and flag 'DRIVER_REST_VIOLATION_ATTEMPT'.",
    "expected_user_behavior": "Operator reschedules shipments to respect rest windows or assigns alternate driver/truck.",
    "admin_or_franchise_action": "Admin reviews repeated scheduling violations and may penalize operator.",
    "failure_condition": "System schedules back-to-back shipments causing driver fatigue and safety risk.",
    "enforcement_rule": "BR-29 / Driver rest & safety policy.",
    "test_hint": "Attempt to assign consecutive shipments without required rest; expect rejection and 'DRIVER_REST_VIOLATION_ATTEMPT'."
  },
  {
    "id": "ST-054",
    "category": "Tracking",
    "trigger": "Driver app sends malformed location data (invalid latitude/longitude values).",
    "expected_system_behavior": "Reject malformed pings; log 'INVALID_GEO_PAYLOAD'; notify driver to update app; do not use malformed data for route or anomaly detection.",
    "expected_user_behavior": "Driver updates app or device; retries correct pings.",
    "admin_or_franchise_action": "Ops tracks devices with repeated malformed payloads for remediation.",
    "failure_condition": "Malformed data stored and used in analytics causing incorrect decisions.",
    "enforcement_rule": "BR-D10 / Geo-ping validation policy.",
    "test_hint": "Send pings with lat=999 or lon=999; expect 4xx validation rejection and log entry."
  },
  {
    "id": "ST-055",
    "category": "Compliance",
    "trigger": "Operator attempts to re-use inspection stamp/token for different trucks within short timeframe.",
    "expected_system_behavior": "Detect reuse of inspection stamp/token; reject inspection and mark unit for 'STAMP_REUSE_SUSPECT'; suspend acceptance of further inspections from that unit until audit.",
    "expected_user_behavior": "Unit provides fresh inspection evidence per truck; operator coordinates legitimate inspections.",
    "admin_or_franchise_action": "District performs audit and applies strikes if confirmed.",
    "failure_condition": "Stamp reuse accepted enabling fake inspections to pass.",
    "enforcement_rule": "BR-FU02 / Inspection authenticity & stamp policies.",
    "test_hint": "Submit inspection payloads using same stamp ID across trucks; expect automated flag and rejection."
  },
  {
    "id": "ST-056",
    "category": "Operator Behavior",
    "trigger": "Operator programmatically retrieves large pages of active bookings to perform off-platform analysis and contact users externally.",
    "expected_system_behavior": "Enforce API pagination and rate limits; redact contact fields in bulk exports; log bulk-access events and require elevated API scope for large exports.",
    "expected_user_behavior": "Operator requests authorized export or uses aggregated metrics; complies with masking rules.",
    "admin_or_franchise_action": "Platform engineering reviews export scopes and may revoke keys for misuse.",
    "failure_condition": "System allows unfettered bulk access exposing masked PII and enabling off-platform contact.",
    "enforcement_rule": "BR-11 / API access control & export governance.",
    "test_hint": "Attempt bulk GET with high page_size; expect 4xx or truncated response plus audit log."
  },
  {
    "id": "ST-057",
    "category": "Delivery",
    "trigger": "Multiple OTPs generated for the same shipment due to repeated re-issue and reuse, causing confusion.",
    "expected_system_behavior": "Maintain a single active OTP per shipment; issuing a new OTP invalidates previous one and logs 'OTP_REISSUE'; enforce short TTL and rate-limit re-issues.",
    "expected_user_behavior": "Shipper uses latest OTP; driver uses corresponding OTP when completing delivery.",
    "admin_or_franchise_action": "Admin may re-issue OTP in verified situations and review OTP request logs for abuse.",
    "failure_condition": "System accepts any older OTP leading to duplicate acceptance windows and fraud risk.",
    "enforcement_rule": "BR-D07 / OTP lifecycle & TTL policy.",
    "test_hint": "Request OTP re-issue twice; verify only latest OTP valid and previous invalidated."
  },
  {
    "id": "ST-058",
    "category": "Tracking",
    "trigger": "Night-time operations in low-GPS-satellite availability area produce sporadic weak-accuracy pings with high dilution-of-precision (DOP).",
    "expected_system_behavior": "Annotate pings with accuracy metrics; downgrade confidence in route and surface 'LOW_GPS_CONFIDENCE' to users; require additional photo evidence for critical checkpoints.",
    "expected_user_behavior": "Driver provides additional corroborating evidence (photos) at key points; operator monitors with reduced confidence.",
    "admin_or_franchise_action": "Ops tracks low-confidence regions and adjusts thresholds or instructs device settings per region.",
    "failure_condition": "System treats low-quality pings as high-confidence leading to false confirmations.",
    "enforcement_rule": "BR-D10 / GPS accuracy & confidence annotation.",
    "test_hint": "Send pings with high DOP/low accuracy flags; expect 'LOW_GPS_CONFIDENCE' notices and UI indicators."
  },
  {
    "id": "ST-059",
    "category": "Compliance",
    "trigger": "Operator uploads forged owner's ID that visually appears valid but fails cryptographic signature check from issuing authority integration.",
    "expected_system_behavior": "Reject KYC document with 'DOC_SIGNATURE_INVALID'; escalate to KYC-admin for manual review and lock account pending resolution.",
    "expected_user_behavior": "Operator resubmits valid signed documents or provides originals for on-site validation.",
    "admin_or_franchise_action": "KYC-admin performs deeper verification and triggers fraud investigations if signature invalid.",
    "failure_condition": "System accepts forged IDs due to lack of signature verification, enabling fraudulent accounts.",
    "enforcement_rule": "BR-3 / KYC signature verification & authoritative validation.",
    "test_hint": "Upload doc with altered signature metadata; expect rejection and KYC-admin queue entry."
  },
  {
    "id": "ST-060",
    "category": "Fraud",
    "trigger": "A sudden spike of refunds/dispute filings from a cluster of shippers in same geography indicates potential orchestrated abuse.",
    "expected_system_behavior": "Detect clustering of disputes; throttle dispute auto-acceptance and mark region for 'POTENTIAL_ORCHESTRATED_ABUSE'; route to HQ fraud team for coordinated investigation.",
    "expected_user_behavior": "Shippers in cluster may be contacted for additional validation; claims processed after investigation.",
    "admin_or_franchise_action": "HQ fraud team investigates pattern, may suspend coordinated accounts and pause payouts if collusion found.",
    "failure_condition": "System processes clustered disputes automatically leading to financial loss and exploitation.",
    "enforcement_rule": "BR-FP04 / Clustered dispute detection & coordinated fraud handling.",
    "test_hint": "Simulate high dispute rate from nearby shippers; expect clustering detection and HQ fraud queue entry."
  },
  {
    "id": "ST-061",
    "category": "Booking",
    "trigger": "Shipper posts booking with hazardous goods flag but omits required hazardous documentation.",
    "expected_system_behavior": "Reject publish; return 'HAZMAT_DOCS_REQUIRED' and surface required document checklist; do not expose booking to operators until docs provided and validated.",
    "expected_user_behavior": "Shipper uploads required hazmat documents and acknowledges special handling rules; retries publish.",
    "admin_or_franchise_action": "HQ compliance reviews complex hazmat approvals when auto-validation fails.",
    "failure_condition": "Booking becomes live without hazmat docs causing legal/safety exposure.",
    "enforcement_rule": "BR-S01 / Hazardous-goods documentation policy.",
    "test_hint": "Attempt to create booking with hazmat=true and no docs; expect rejection and guidance."
  },
  {
    "id": "ST-062",
    "category": "Bidding",
    "trigger": "Operator's API key is rotated mid-session causing in-flight bid modification to fail unexpectedly.",
    "expected_system_behavior": "Fail gracefully with 'AUTH_KEY_ROTATED'; ensure idempotency for bid update attempts and provide clear retry guidance; log rotation event against operator key.",
    "expected_user_behavior": "Operator re-authenticates with new key and retries operation safely.",
    "admin_or_franchise_action": "Platform engineering traces key rotation and assists operator with recovery if needed.",
    "failure_condition": "Partial bid updates persisted leaving inconsistent bid state.",
    "enforcement_rule": "BR-O08 / Auth & idempotency policy for critical operations.",
    "test_hint": "Rotate operator key during bid PATCH; expect atomic failure and clean rollback."
  },
  {
    "id": "ST-063",
    "category": "Shipment",
    "trigger": "Assigned truck develops mechanical issues en route and driver marks 'breakdown' but operator fails to propose alternate within SLA.",
    "expected_system_behavior": "Escalate to Admin after SLA (configurable) and mark shipment 'REQUIRES_ALTERNATE'; auto-notify nearby compliant operators if allowed by policy; keep shipment ID live.",
    "expected_user_behavior": "Operator assigns alternate compliant truck promptly or Admin reassigns per SLA.",
    "admin_or_franchise_action": "Admin intervenes to allocate alternate truck; Unit Franchise may coordinate on-ground assistance.",
    "failure_condition": "Shipment remains stuck without alternate assignment beyond SLA without escalation.",
    "enforcement_rule": "BR-SL06 / Alternate truck & breakdown SLA policy.",
    "test_hint": "Simulate breakdown and operator non-response past SLA; expect admin escalation and alternate allocation workflow."
  },
  {
    "id": "ST-064",
    "category": "Tracking",
    "trigger": "Geo-fence event expected at pickup/drop is not triggered though pings show device within geofence (radius precision edge-case).",
    "expected_system_behavior": "Run high-precision re-evaluation using buffered geofence tolerance; if still mismatched, flag 'GEOFENCE_MISS' and require driver photo verification for the event; log geometry edge-case for ops tuning.",
    "expected_user_behavior": "Driver provides photo evidence; operator acknowledges and proceeds if validated.",
    "admin_or_franchise_action": "Ops reviews geofence configuration and adjusts tolerance if region-specific issue identified.",
    "failure_condition": "System silently ignores missed geofence events causing false non-delivery states.",
    "enforcement_rule": "BR-D04 / Geofence verification + buffered tolerance policy.",
    "test_hint": "Simulate pings on geofence boundary; verify buffered check and fallback to photo verification."
  },
  {
    "id": "ST-065",
    "category": "Compliance",
    "trigger": "Bulk KYC ingestion job experiences partial failure resulting in mixed 'verified' and 'pending' flags for same operator entities.",
    "expected_system_behavior": "Rollback partial results or mark inconsistent records as 'KYC_INGEST_INCONSISTENT'; pause dependent actions (bidding/assignments) for affected operators until reconciliation; notify KYC-admin.",
    "expected_user_behavior": "Operator remains able to view status and awaits resolution; retries not permitted until reconciliation.",
    "admin_or_franchise_action": "KYC-admin triggers reconciliation job and manually verifies affected records; issue corrective patches.",
    "failure_condition": "Operator gets inconsistent privileges causing unauthorized actions or blocked legitimate flows.",
    "enforcement_rule": "BR-3 / KYC ingestion atomicity & reconciliation policy.",
    "test_hint": "Simulate partial ingestion with induced failure; expect transaction rollback or marking of inconsistent records pending manual reconciliation."
  },
  {
    "id": "ST-066",
    "category": "Operator Behavior",
    "trigger": "Operator schedules automatic nightly maintenance window and attempts bidding during window due to clock misconfiguration.",
    "expected_system_behavior": "Honor maintenance window: reject new bids with 'MAINTENANCE_WINDOW' and surface ETA; ensure queued operations are executed after maintenance; log operator-config mismatch.",
    "expected_user_behavior": "Operator reschedules business-critical operations outside maintenance or requests emergency exception via Admin.",
    "admin_or_franchise_action": "Platform engineering reviews maintenance scheduling conflicts and may lift window for emergency operations under controlled conditions.",
    "failure_condition": "System accepts bids during maintenance causing data corruption or partial failures.",
    "enforcement_rule": "BR-SL07 / Maintenance window enforcement & graceful degradation policy.",
    "test_hint": "Configure maintenance window and attempt bid; expect 503-like response and queued retry guidance."
  },
  {
    "id": "ST-067",
    "category": "Delivery",
    "trigger": "Shipper requests POD in a language not supported by OCR locale fallback causing unreadable OCR results.",
    "expected_system_behavior": "Accept POD upload but mark OCR confidence low; route to human review queue for locale-specific verification; allow manual acceptance after verification.",
    "expected_user_behavior": "Shipper/driver cooperate with manual verification; provide additional clarifying photos or metadata.",
    "admin_or_franchise_action": "Admin/KYC team assigns human reviewer fluent in locale for verification; system tracks time-to-verify SLA.",
    "failure_condition": "System auto-accepts low-confidence OCR results causing evidence gaps in disputes.",
    "enforcement_rule": "BR-D11 / POD OCR locale fallback & human-review policy.",
    "test_hint": "Upload POD with regional language characters unsupported by OCR; expect low-confidence flag and manual review ticket."
  },
  {
    "id": "ST-068",
    "category": "Tracking",
    "trigger": "Third-party map routing API returns drastically different ETA than internal route heuristics just before assignment.",
    "expected_system_behavior": "Surface both ETA estimates with confidence scores to user and log discrepancy 'ETA_MISMATCH'; avoid auto-accepting outlier ETA for SLA enforcement until reconciled; flag for ops tuning.",
    "expected_user_behavior": "Operator and shipper see discrepancy and adjust expectations; operator may cancel or confirm assignment after review.",
    "admin_or_franchise_action": "Ops investigates mapping provider discrepancy and may update heuristics or switch routing provider if persistent.",
    "failure_condition": "System silently trusts erroneous ETA causing SLA breaches and misrouted expectations.",
    "enforcement_rule": "BR-S01 / Route & ETA reconciliation policy.",
    "test_hint": "Mock routing API to return extreme ETA; verify both ETAs displayed and a discrepancy log entry created."
  },
  {
    "id": "ST-069",
    "category": "Compliance",
    "trigger": "Operator attempts to reactivate a truck that was permanently blocked for prior serious violation by creating a new operator account.",
    "expected_system_behavior": "Detect linkage signals (phone, device, bank, number plates) and flag 'RELATED_ACCOUNT_REACTIVATION_ATTEMPT'; block activation pending HQ compliance review and require human adjudication.",
    "expected_user_behavior": "Operator cannot bypass ban; must appeal through HQ with evidence and legal identity proof.",
    "admin_or_franchise_action": "HQ Compliance investigates linkage and enforces permanent ban if confirmed; legal escalation if fraud detected.",
    "failure_condition": "System allows banned entities to re-enter via new accounts undermining enforcement.",
    "enforcement_rule": "BR-FP01 / Related-account detection & enforcement policy.",
    "test_hint": "Create new operator with linked identifiers of blocked operator; expect detection and hold."
  },
  {
    "id": "ST-070",
    "category": "Fraud",
    "trigger": "A scripted attack targets OTP endpoint attempting brute-force OTP guesses across many shipments concurrently.",
    "expected_system_behavior": "Rate-limit OTP verification attempts per shipment and per driver/device; global anomaly detection triggers 'OTP_BRUTE_FORCE' defense: lock affected shipments, require multi-factor re-issue, and notify Admin; add IP/device blocks as needed.",
    "expected_user_behavior": "Drivers stop attempts; operator contacts Admin to resolve legitimate cases.",
    "admin_or_franchise_action": "Security team rotates OTP mechanism thresholds, investigates attack source, and may block attacker IP ranges.",
    "failure_condition": "System allows unlimited OTP attempts enabling unauthorized completions and fraud.",
    "enforcement_rule": "BR-D07 / OTP brute-force protection & rate-limiting policy.",
    "test_hint": "Simulate high-rate invalid OTP calls from multiple IPs; expect per-shipment lock and global defense triggers."
  },
  {
    "id": "ST-071",
    "category": "Booking",
    "trigger": "Shipper posts booking with intentionally vague goods description (e.g., 'material', 'some goods') to hide nature of cargo.",
    "expected_system_behavior": "Reject vague descriptions; require specific goods classification; return 'GOODS_DESCRIPTION_INSUFFICIENT'; booking not published until corrected.",
    "expected_user_behavior": "Shipper provides detailed goods description per categories.",
    "admin_or_franchise_action": "Admin may review repeat offenders and restrict posting privileges.",
    "failure_condition": "Booking with ambiguous cargo is published causing safety/regulatory failures.",
    "enforcement_rule": "BR-S01 / Goods description completeness policy.",
    "test_hint": "Submit booking with vague goods text; expect error and validation block."
  },
  {
    "id": "ST-072",
    "category": "Bidding",
    "trigger": "Operator attempts to reduce bid amount BELOW system-minimum operational viability threshold (after validation stage).",
    "expected_system_behavior": "Auto-block bid as 'NON-VIABLE_RATE'; require operator acknowledgement before retry.",
    "expected_user_behavior": "Operator adjusts bid within allowable viability range.",
    "admin_or_franchise_action": "Admin investigates if repeated attempts indicate predatory or bot bidding.",
    "failure_condition": "System accepts non-viable bid, collapsing cost-to-serve model.",
    "enforcement_rule": "BR-4 / Economic viability guardrails.",
    "test_hint": "Post bid below viability floor; expect rejection and guardrail log."
  },
  {
    "id": "ST-073",
    "category": "Shipment",
    "trigger": "Driver reaches drop location but shipper is unavailable/unreachable for OTP confirmation.",
    "expected_system_behavior": "Trigger fallback flow: reachability attempts → optional Admin-assisted OTP verification → evidence photo submission; shipment cannot auto-complete.",
    "expected_user_behavior": "Driver waits per SLA, uploads location photos, and escalates via operator.",
    "admin_or_franchise_action": "Admin contacts shipper; may issue manual secure OTP after identity validation.",
    "failure_condition": "Shipment completes WITHOUT OTP due to unresponsive shipper.",
    "enforcement_rule": "BR-D07 / OTP mandatory; fallback protocol policy.",
    "test_hint": "Simulate unreachable shipper; ensure fallback route and block completion."
  },
  {
    "id": "ST-074",
    "category": "Tracking",
    "trigger": "Device repeatedly flips between GPS ON/OFF every few minutes to evade tracking while appearing active.",
    "expected_system_behavior": "Detect behavior as 'PULSE_TRACKING_EVASION'; freeze shipment; require driver justification and continuous tracking mode.",
    "expected_user_behavior": "Driver must stabilize device GPS and provide justification.",
    "admin_or_franchise_action": "Admin escalates suspicious cases; District Franchise may verify physically if patterned.",
    "failure_condition": "System treats pulsed tracking as normal, causing major blind spots.",
    "enforcement_rule": "BR-FE / Tracking evasion detection.",
    "test_hint": "Simulate alternating ON/OFF location events; expect evasion detection and freeze."
  },
  {
    "id": "ST-075",
    "category": "Compliance",
    "trigger": "Inspection finds minor faults but franchise marks truck fully PASSED without flagging minor issues.",
    "expected_system_behavior": "System enforces multi-level inspection scoring; minor issues require 'CONDITIONAL_PASS' with remediation tasks; cannot be marked fully passed.",
    "expected_user_behavior": "Franchise updates inspection with accurate severity levels.",
    "admin_or_franchise_action": "District audits franchise marking accuracy; repeated misclassification triggers penalty.",
    "failure_condition": "Truck passes despite unresolved minor issues creating liability.",
    "enforcement_rule": "BR-C01 / Multi-tier inspection severity rules.",
    "test_hint": "Submit inspection with known minor issues but 'PASS'; expect rejection and require conditional pass."
  },
  {
    "id": "ST-076",
    "category": "Operator Behavior",
    "trigger": "Operator frequently cancels driver assignments immediately before shipper approval to game the SLA timer.",
    "expected_system_behavior": "Detect repeated last-moment cancellations; impose cooldown timer; flag 'ASSIGNMENT_MANIPULATION'; temporarily block assignment privilege if pattern persists.",
    "expected_user_behavior": "Operator performs proper assignments without gaming SLA rules.",
    "admin_or_franchise_action": "Admin monitors and may impose penalties or training.",
    "failure_condition": "System allows manipulation enabling operators to delay SLA unfairly.",
    "enforcement_rule": "BR-O13 / Anti-manipulation assignment policy.",
    "test_hint": "Perform multiple pre-approval cancellations; expect cooldown + manipulation flag."
  },
  {
    "id": "ST-077",
    "category": "Delivery",
    "trigger": "Driver attempts to upload POD before reaching within acceptable geofence of drop location.",
    "expected_system_behavior": "Reject POD with 'EARLY_POD_SUBMISSION'; require updated location and proper drop photo.",
    "expected_user_behavior": "Driver completes delivery physically and reuploads valid evidence.",
    "admin_or_franchise_action": "Admin reviews premature POD attempts for fraud risk.",
    "failure_condition": "System accepts early POD enabling false delivery claims.",
    "enforcement_rule": "BR-D11 / POD geo-verified submission policy.",
    "test_hint": "Attempt POD upload far from drop; expect rejection and geo-distance explanation."
  },
  {
    "id": "ST-078",
    "category": "Tracking",
    "trigger": "Device sends random jitter spikes at specific intervals indicating GPS spoofing via scripted emulator.",
    "expected_system_behavior": "Match temporal patterns to spoof signatures; mark driver/device as 'SCRIPTED_GPS_SPOOFING'; freeze shipment and force verification.",
    "expected_user_behavior": "Driver must switch device or undergo verification.",
    "admin_or_franchise_action": "Admin escalates to fraud team; repeated offenders permanently banned.",
    "failure_condition": "System fails to detect patterned spoofing leading to inaccurate shipment location.",
    "enforcement_rule": "BR-FE / Scripted spoof detection.",
    "test_hint": "Supply location spikes at precise intervals; expect spoof flag and freeze."
  },
  {
    "id": "ST-079",
    "category": "Compliance",
    "trigger": "Truck expired documents auto-block but operator repeatedly attempts to assign blocked truck to shipments.",
    "expected_system_behavior": "Auto-block assignment attempts; log repeated violations; after threshold, temporarily suspend operator's bidding privileges.",
    "expected_user_behavior": "Operator updates documentation and requests inspection.",
    "admin_or_franchise_action": "District Franchise reviews operator behavior and imposes compliance training.",
    "failure_condition": "System allows assignment from blocked trucks compromising safety.",
    "enforcement_rule": "BR-SL01 / Auto-block enforcement.",
    "test_hint": "Attempt assignment with blocked truck 3 times; expect escalating responses and temporary suspension."
  },
  {
    "id": "ST-080",
    "category": "Fraud",
    "trigger": "Multiple operators coordinating price patterns to fix minimum bid levels (cartel behavior).",
    "expected_system_behavior": "Detect correlated bidding patterns via fraud engine; apply 'CARTEL_PATTERN_SUSPECT'; freeze impacted bids; notify HQ for investigation.",
    "expected_user_behavior": "Operators must submit independent bids; cartel behavior blocked.",
    "admin_or_franchise_action": "HQ fraud team investigates; may suspend all involved operators.",
    "failure_condition": "System accepts cartel-driven bids reducing marketplace fairness.",
    "enforcement_rule": "BR-FP04 / Collusive bidding prevention.",
    "test_hint": "Feed multiple identical bids from different operators across bookings; expect cartel detection."
  },
  {
    "id": "ST-081",
    "category": "Booking",
    "trigger": "Shipper attempts to attach prohibited goods (e.g., illegal/restricted items) flagged by keyword list.",
    "expected_system_behavior": "Reject booking with 'PROHIBITED_GOODS' and present remediation/legal guidance; block exposure to operators.",
    "expected_user_behavior": "Shipper revises booking to remove prohibited goods or contacts HQ for permitted exceptions with legal permits.",
    "admin_or_franchise_action": "HQ Compliance reviews any exception requests and logs incident for legal audit.",
    "failure_condition": "Booking created and exposed with prohibited goods leading to legal risk.",
    "enforcement_rule": "BR-S01 / Prohibited goods validation & legal hold.",
    "test_hint": "Submit booking with banned keyword; expect rejection and 'PROHIBITED_GOODS' response."
  },
  {
    "id": "ST-082",
    "category": "Bidding",
    "trigger": "Operator programmatically queries historical bid data to infer competitor behavior and attempts to adapt bids in near real-time.",
    "expected_system_behavior": "Throttle historical-data API access; return aggregated metrics only and log high-frequency analytics queries as 'META_ANALYTICS_ABUSE'.",
    "expected_user_behavior": "Operator must request aggregated analytics or use platform-paid analytics product.",
    "admin_or_franchise_action": "Platform engineering may provision controlled analytics access and audit misuse.",
    "failure_condition": "System exposes granular historical bid data enabling algorithmic exploitation.",
    "enforcement_rule": "BR-O08 / Analytics access control & rate-limiting.",
    "test_hint": "Issue high-frequency historical queries; expect aggregated response and abuse log entry."
  },
  {
    "id": "ST-083",
    "category": "Shipment",
    "trigger": "Assigned truck hit by force majeure (road closure/flood) mid-journey requiring dynamic reroute across much longer distance.",
    "expected_system_behavior": "Pause SLA timers, notify shipper/operator/admin of major reroute, calculate new cost/time estimates, and require shipper reconfirmation if new ETA or route exceeds threshold.",
    "expected_user_behavior": "Shipper accepts new route/ETA or requests cancellation per policy; operator proposes alternate path or truck if needed.",
    "admin_or_franchise_action": "Admin monitors multiple force-majeure incidents and may implement temporary routing policies.",
    "failure_condition": "System auto-applies long reroutes without shipper notice leading to disputes.",
    "enforcement_rule": "BR-S01 / Force-majeure reroute notification & reconfirmation.",
    "test_hint": "Simulate route closure mid-trip and request reroute; expect notifications and reconfirmation gate if thresholds exceeded."
  },
  {
    "id": "ST-084",
    "category": "Tracking",
    "trigger": "Driver uses device with disabled background location permissions causing pings only when app foregrounded.",
    "expected_system_behavior": "Mark device as 'BACKGROUND_LOCATION_DISABLED'; warn operator and driver; downgrade tracking confidence and require more frequent manual check-ins until resolved.",
    "expected_user_behavior": "Driver enables background location or uses approved device; operator monitors with caution.",
    "admin_or_franchise_action": "Unit Franchise may escalate to driver to change device or re-configure app.",
    "failure_condition": "System treats intermittent foreground-only pings as full tracking coverage.",
    "enforcement_rule": "BR-D10 / Background-location enforcement & confidence downgrade.",
    "test_hint": "Register device with foreground-only pings; expect 'BACKGROUND_LOCATION_DISABLED' warning and reduced confidence state."
  },
  {
    "id": "ST-085",
    "category": "Compliance",
    "trigger": "System auto-unblocks a truck after document refresh but post-unblock automated checks find mismatched owner name vs Aadhar/PAN metadata.",
    "expected_system_behavior": "Re-block truck and create 'OWNER_MISMATCH' compliance case; prevent auto-unblock if automated cross-checks fail; require manual KYC-admin reconciliation.",
    "expected_user_behavior": "Operator provides legal proof of ownership transfer and supports manual verification.",
    "admin_or_franchise_action": "KYC-admin reviews documents and either clear or escalate to HQ/legal for fraud handling.",
    "failure_condition": "System remains unblocked with owner mismatch enabling fraudulent operations.",
    "enforcement_rule": "BR-SL01 / Owner verification & auto-unblock safeguard.",
    "test_hint": "Refresh docs with mismatched owner metadata; ensure re-block and KYC-admin queue entry."
  },
  {
    "id": "ST-086",
    "category": "Operator Behavior",
    "trigger": "Operator schedules automated scripts to accept low-probability bookings en masse (auto-accept abuse).",
    "expected_system_behavior": "Detect high-rate auto-accept patterns; throttle auto-accept capabilities; require operator to validate capacity and confirm manual acceptance after threshold.",
    "expected_user_behavior": "Operator disables abusive automation or requests platform-level exception with capacity proof.",
    "admin_or_franchise_action": "Admin suspends auto-accept for offending operator and reviews patterns for misuse.",
    "failure_condition": "System allows unbounded auto-accepts causing operator overcommitment and SLA failure.",
    "enforcement_rule": "BR-O12 / Auto-accept throttle & capacity validation policy.",
    "test_hint": "Simulate mass auto-accept calls; expect throttling and suspension of auto-accept."
  },
  {
    "id": "ST-087",
    "category": "Delivery",
    "trigger": "Driver submits POD where the goods weight exceeds declared tonnage by a large margin.",
    "expected_system_behavior": "Flag discrepancy 'WEIGHT_MISMATCH'; hold settlement and open investigation; require operator to provide weighbridge/slip evidence before release.",
    "expected_user_behavior": "Operator supplies weighbridge data or justification; shipper notified of discrepancy.",
    "admin_or_franchise_action": "Admin validates evidence and adjudicates settlement adjustments if necessary.",
    "failure_condition": "System accepts POD without validating weight mismatch leading to fraud or overloading risk.",
    "enforcement_rule": "BR-D11 / POD weight reconciliation policy.",
    "test_hint": "Upload POD with weight >> declared; expect 'WEIGHT_MISMATCH' hold and evidence request."
  },
  {
    "id": "ST-088",
    "category": "Tracking",
    "trigger": "GPS provider outage causes third-party routing API to fail returning routes/ETAs for many bookings simultaneously.",
    "expected_system_behavior": "Fallback to local route heuristics; mark affected shipments 'ROUTING_FALLBACK'; notify users and log provider outage; avoid blocking shipments where safe fallback exists.",
    "expected_user_behavior": "Operator monitors and adjusts expectations; shipper notified of reduced ETA confidence.",
    "admin_or_franchise_action": "Ops escalates to mapping vendor and may switch failover provider if SLA breached.",
    "failure_condition": "System fully blocks shipments instead of using fallback heuristics leading to unnecessary disruptions.",
    "enforcement_rule": "BR-S01 / Routing provider fallback & resilience policy.",
    "test_hint": "Simulate routing API outage; expect fallback heuristics used and 'ROUTING_FALLBACK' state."
  },
  {
    "id": "ST-089",
    "category": "Compliance",
    "trigger": "Mass re-verification campaign where many trucks submit documents at once causing queue overload and delayed inspections.",
    "expected_system_behavior": "Prioritize high-risk trucks first, provide transparent queue ETA, allow provisional limited bidding for low-risk trucks under monitoring, and scale inspection resources (manual or automated) as configured.",
    "expected_user_behavior": "Operators monitor queue and prioritize urgent trucks; franchises allocate resources per priority.",
    "admin_or_franchise_action": "District redistributes inspection workload and HQ may provision temporary audit teams.",
    "failure_condition": "Queue overload causes unsafe trucks to remain active or complete reactivation without adequate verification.",
    "enforcement_rule": "BR-C02 / Mass re-verification prioritization & queuing policy.",
    "test_hint": "Submit bulk document refresh for many trucks; verify prioritization and provisional rules applied."
  },
  {
    "id": "ST-090",
    "category": "Fraud",
    "trigger": "Coordinated device spoof where attacker rotates device IDs and uses proxy IPs to evade device-account collision detection.",
    "expected_system_behavior": "Correlate multi-signal telemetry (SIM, bank account, vehicle plate, behavioral patterns) to detect linkage despite device rotation; raise 'HIGHLY_SOPHISTICATED_EVASION' and lock affected accounts pending forensic review.",
    "expected_user_behavior": "Operators/drivers cannot bypass holds; must prove identity through HQ process.",
    "admin_or_franchise_action": "Security & HQ forensic team engage for deeper investigation and legal action as needed.",
    "failure_condition": "Attacker evades detection and continues fraudulent activity undetected.",
    "enforcement_rule": "BR-FE / Multi-signal correlation & advanced evasion detection.",
    "test_hint": "Simulate rotated device/proxy patterns with shared bank/plate identifiers; expect cross-signal detection and forensic lock."
  },
  {
    "id": "ST-091",
    "category": "Booking",
    "trigger": "Shipper posts multiple bookings with intentionally manipulated pickup timestamps (backdated/future-dated) to game demand visibility.",
    "expected_system_behavior": "Detect temporal anomalies; mark 'INVALID_PICKUP_TIME'; require shipper confirmation or correction before allowing bids.",
    "expected_user_behavior": "Shipper corrects timestamp or provides justification.",
    "admin_or_franchise_action": "Admin audits repeated anomalies; may throttle booking privileges.",
    "failure_condition": "System publishes fraudulent timestamps influencing operator demand prediction.",
    "enforcement_rule": "BR-S01 / Temporal booking integrity policy.",
    "test_hint": "Submit pickup time 2 days in past; expect rejection and validation error."
  },
  {
    "id": "ST-092",
    "category": "Bidding",
    "trigger": "Operator attempts to revoke a winning bid AFTER auto-finalization but BEFORE shipment creation.",
    "expected_system_behavior": "Block revocation; winning bid becomes locked; require admin override only in exceptional cases with justification.",
    "expected_user_behavior": "Operator proceeds with truck/driver assignment.",
    "admin_or_franchise_action": "Admin may override in rare justified cases and logs must show reason + approval chain.",
    "failure_condition": "Operator revokes winning bid causing booking deadlock.",
    "enforcement_rule": "BR-SL07 / Finalization immutability rule.",
    "test_hint": "Call DELETE on winning bid post-finalization; expect 403 and audit log."
  },
  {
    "id": "ST-093",
    "category": "Shipment",
    "trigger": "Driver attempts to start shipment without physically reaching pickup geofence.",
    "expected_system_behavior": "Reject 'START_TRIP' with 'NOT_AT_PICKUP_LOCATION'; require driver to provide geotagged pickup proof or move closer to geofence.",
    "expected_user_behavior": "Driver moves to pickup point and retries.",
    "admin_or_franchise_action": "Admin monitors repeated starts outside geofence as suspicious.",
    "failure_condition": "Shipment starts without proximity validation, enabling fraudulent starts.",
    "enforcement_rule": "BR-D04 / Pickup geofence validation.",
    "test_hint": "Trigger startTrip with device >1 km from pickup; expect rejection."
  },
  {
    "id": "ST-094",
    "category": "Tracking",
    "trigger": "Driver device timezone suddenly shifts (manually or automatically), creating inconsistent ping timestamps.",
    "expected_system_behavior": "Normalize timestamps server-side; detect timezone shift; annotate pings with 'TIMEZONE_SHIFT'; continue reliable tracking.",
    "expected_user_behavior": "Driver adjusts device settings or follows app instructions.",
    "admin_or_franchise_action": "Ops checks if device compromised or misconfigured.",
    "failure_condition": "System logs inaccurate timestamps breaking shipment sequence logic.",
    "enforcement_rule": "BR-SL08 / Time normalization & drift correction.",
    "test_hint": "Simulate timezone jump of +5 hours; expect normalization + 'TIMEZONE_SHIFT' log."
  },
  {
    "id": "ST-095",
    "category": "Compliance",
    "trigger": "Operator uploads new registration certificate (RC) but OCR mismatch shows discrepancy in chassis number.",
    "expected_system_behavior": "Flag 'CHASSIS_MISMATCH'; hold truck in 'UNDER_REVIEW'; require manual verification.",
    "expected_user_behavior": "Operator submits original RC or visits franchise office for validation.",
    "admin_or_franchise_action": "Unit Franchise validates original physical RC; District audits mismatches >2 occurrences.",
    "failure_condition": "System accepts mismatched RC allowing fraudulent trucks on platform.",
    "enforcement_rule": "BR-FU02 / Chassis number OCR validation.",
    "test_hint": "Upload RC with altered chassis number; expect mismatch flag and hold."
  },
  {
    "id": "ST-096",
    "category": "Operator Behavior",
    "trigger": "Operator copies and pastes the same driver-accreditation photo across different drivers to speed up KYC.",
    "expected_system_behavior": "Detect duplicate-image hash; mark submission as 'DUPLICATE_DRIVER_KYC'; freeze all pending driver KYCs from operator.",
    "expected_user_behavior": "Operator must upload authentic photos for each driver.",
    "admin_or_franchise_action": "KYC-admin investigates operator; possible temporary suspension.",
    "failure_condition": "System accepts duplicated identity images enabling identity fraud.",
    "enforcement_rule": "BR-D01 / Driver KYC uniqueness enforcement.",
    "test_hint": "Upload same face photo for two drivers; expect duplicate hash flag."
  },
  {
    "id": "ST-097",
    "category": "Delivery",
    "trigger": "Driver requests OTP multiple times from shipper but shipper suspects impersonation.",
    "expected_system_behavior": "Trigger identity verification fallback: require driver live selfie + geotag before OTP re-issue; block repetitive OTP requests.",
    "expected_user_behavior": "Driver submits live selfie; shipper reviews secure channel confirmation.",
    "admin_or_franchise_action": "Admin handles identity suspicion and validates driver credentials.",
    "failure_condition": "System issues new OTP without identity validation enabling impersonation.",
    "enforcement_rule": "BR-D07 / Secure OTP re-issue policy.",
    "test_hint": "Request OTP 3 times in short window; expect re-issue lock and identity verification requirement."
  },
  {
    "id": "ST-098",
    "category": "Tracking",
    "trigger": "Driver uses battery saver mode aggressively causing intermittent GPS cut-offs.",
    "expected_system_behavior": "Detect abnormal ping gaps correlated with battery state; warn driver 'LOW_POWER_MODE_IMPACTING_TRACKING'; downgrade tracking confidence; escalate if repeated.",
    "expected_user_behavior": "Driver disables aggressive power-saving features.",
    "admin_or_franchise_action": "Ops may mandate device guidelines for drivers with repeated issues.",
    "failure_condition": "System interprets power-saving gaps as normal causing blind spots.",
    "enforcement_rule": "BR-D10 / Battery-state-aware tracking reliability.",
    "test_hint": "Send pings with battery=low + intermittent drop; expect warning and confidence downgrade."
  },
  {
    "id": "ST-099",
    "category": "Compliance",
    "trigger": "Franchise attempts to approve inspection for truck whose photos were taken outside designated inspection zone.",
    "expected_system_behavior": "Detect location mismatch; reject inspection with 'OUT_OF_ZONE_INSPECTION'; require on-location inspection redo.",
    "expected_user_behavior": "Franchise performs inspection within approved geo-zone.",
    "admin_or_franchise_action": "District Franchise audits geography misuse; apply penalties.",
    "failure_condition": "System accepts out-of-zone inspections allowing fake evaluations.",
    "enforcement_rule": "BR-FU02 / Inspection zone enforcement.",
    "test_hint": "Submit inspection photos with geotag 50km away from approved zone; expect rejection."
  },
  {
    "id": "ST-100",
    "category": "Fraud",
    "trigger": "Driver, operator, and shipper collude to fake delivery completion and share proceeds off-platform.",
    "expected_system_behavior": "Detect collusion via multi-signal analysis (route anomalies, OTP patterns, POD patterns, repeated user triads); freeze shipment; lock accounts; require HQ fraud investigation.",
    "expected_user_behavior": "Users under investigation cannot perform new actions until cleared.",
    "admin_or_franchise_action": "HQ fraud team conducts interviews, escalates legal action, and bans entities involved.",
    "failure_condition": "System fails to detect triad collusion enabling large-scale fraud.",
    "enforcement_rule": "BR-FP01 / Multi-party collusion detection.",
    "test_hint": "Simulate repeated triad of shipper/operator/driver with suspicious patterns; expect collusion flag and freeze."
  }
]
